<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Tools</title>
    <link rel="stylesheet" href="common.css">
    <style>
        body {
            padding: 48px 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        header { margin-bottom: 32px; }

        main {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .filter-container {
            width: 100%;
            max-width: 480px;
            margin-bottom: 32px;
        }

        .filter-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--input-border);
            border-radius: var(--radius-lg);
            font-size: 0.9375rem;
            background: var(--card-bg);
            color: var(--text-primary);
            outline: none;
            box-shadow: var(--shadow-sm);
            transition: border-color 0.15s, box-shadow 0.15s;
        }

        .filter-input:hover {
            border-color: var(--text-muted);
        }

        .filter-input:focus {
            border-color: var(--input-border-focus);
            box-shadow: var(--shadow-sm), 0 0 0 3px var(--ring-color);
        }

        .filter-input::placeholder {
            color: var(--text-muted);
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 16px;
            max-width: 960px;
            width: 100%;
        }

        .tool-card {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--radius-lg);
            padding: 20px;
            text-decoration: none;
            color: inherit;
            box-shadow: var(--shadow-sm);
            transition: box-shadow 0.2s, border-color 0.2s;
        }

        .tool-card:hover {
            box-shadow: var(--shadow-md);
            border-color: var(--text-muted);
        }

        .tool-card:focus,
        .tool-card.selected {
            outline: none;
            box-shadow: var(--shadow-sm), 0 0 0 3px var(--ring-color);
            border-color: var(--input-border-focus);
        }

        .tool-card.hidden { display: none; }

        .tool-title {
            margin: 0 0 6px 0;
            font-size: 0.9375rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .tool-description {
            margin: 0;
            color: var(--text-secondary);
            font-size: 0.8125rem;
            line-height: 1.5;
        }

        .no-results {
            text-align: center;
            color: var(--text-muted);
            padding: 48px 24px;
            display: none;
            font-size: 0.9375rem;
        }

        @media (max-width: 640px) {
            body { padding: 32px 16px; }
            .tools-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <h1>Browser-based Tools</h1>
    </header>

    <main>
        <div class="filter-container">
            <input type="text" id="filterInput" class="filter-input" placeholder="Filter tools..." autofocus aria-label="Filter tools">
        </div>

        <div class="tools-grid" id="toolsGrid" role="list">
            <a href="base64.html" class="tool-card" data-keywords="base64 encode decode binary" role="listitem">
                <h2 class="tool-title">Base64</h2>
                <p class="tool-description">Encode/decode Base64 bidirectionally</p>
            </a>

            <a href="clipboard-viewer.html" class="tool-card" data-keywords="clipboard paste formats inspect debug" role="listitem">
                <h2 class="tool-title">Clipboard Viewer</h2>
                <p class="tool-description">Inspect all clipboard formats and data</p>
            </a>

            <a href="color-converter.html" class="tool-card" data-keywords="color hex rgb hsl oklch" role="listitem">
                <h2 class="tool-title">Color Converter</h2>
                <p class="tool-description">HEX, RGB, HSL, OKLCH and more</p>
            </a>

            <a href="csv-to-json.html" class="tool-card" data-keywords="csv json convert table" role="listitem">
                <h2 class="tool-title">CSV to JSON</h2>
                <p class="tool-description">Convert CSV with custom options</p>
            </a>

            <a href="datetime-converter.html" class="tool-card" data-keywords="date time timestamp unix iso rfc epoch convert format" role="listitem">
                <h2 class="tool-title">Date-Time Converter</h2>
                <p class="tool-description">Convert between date/time formats</p>
            </a>

            <a href="diff.html" class="tool-card" data-keywords="diff compare difference text" role="listitem">
                <h2 class="tool-title">Diff</h2>
                <p class="tool-description">Compare text with colored diff</p>
            </a>

            <a href="exif-viewer.html" class="tool-card" data-keywords="exif metadata image photo gps location" role="listitem">
                <h2 class="tool-title">EXIF Viewer</h2>
                <p class="tool-description">Extract metadata from images</p>
            </a>

            <a href="html-entities.html" class="tool-card" data-keywords="html entity encode decode escape" role="listitem">
                <h2 class="tool-title">HTML Entities</h2>
                <p class="tool-description">Encode/decode HTML entities</p>
            </a>

            <a href="iban-validator.html" class="tool-card" data-keywords="iban validate bank account bban qr sepa" role="listitem">
                <h2 class="tool-title">IBAN Validator</h2>
                <p class="tool-description">Validate and parse IBAN numbers</p>
            </a>

            <a href="json-formatter.html" class="tool-card" data-keywords="json format pretty minify" role="listitem">
                <h2 class="tool-title">JSON Formatter</h2>
                <p class="tool-description">Pretty print or minify JSON</p>
            </a>

            <a href="json-to-yaml.html" class="tool-card" data-keywords="json yaml convert" role="listitem">
                <h2 class="tool-title">JSON to YAML</h2>
                <p class="tool-description">Convert JSON to YAML in real-time</p>
            </a>

            <a href="jwt-decoder.html" class="tool-card" data-keywords="jwt token decode auth" role="listitem">
                <h2 class="tool-title">JWT Decoder</h2>
                <p class="tool-description">Decode and inspect JWT tokens</p>
            </a>

            <a href="markdown-preview.html" class="tool-card" data-keywords="markdown md preview html" role="listitem">
                <h2 class="tool-title">Markdown Preview</h2>
                <p class="tool-description">Live markdown to HTML preview</p>
            </a>

            <a href="ocr.html" class="tool-card" data-keywords="ocr text extract image pdf tesseract" role="listitem">
                <h2 class="tool-title">OCR</h2>
                <p class="tool-description">Extract text from images and PDFs</p>
            </a>

            <a href="password-generator.html" class="tool-card" data-keywords="password generate random secure strong" role="listitem">
                <h2 class="tool-title">Password Generator</h2>
                <p class="tool-description">Generate secure random passwords</p>
            </a>

            <a href="paste-rich-text.html" class="tool-card" data-keywords="paste rich text html extract clipboard" role="listitem">
                <h2 class="tool-title">Paste Rich Text</h2>
                <p class="tool-description">Extract HTML from pasted rich text</p>
            </a>

            <a href="qr-generator.html" class="tool-card" data-keywords="qr code generate barcode scan" role="listitem">
                <h2 class="tool-title">QR Code Generator</h2>
                <p class="tool-description">Generate styled QR codes with PNG/SVG download</p>
            </a>

            <a href="regex-tester.html" class="tool-card" data-keywords="regex regular expression test pattern" role="listitem">
                <h2 class="tool-title">Regex Tester</h2>
                <p class="tool-description">Test JS regex with highlighting</p>
            </a>

            <a href="roman-numerals.html" class="tool-card" data-keywords="roman numerals number convert latin" role="listitem">
                <h2 class="tool-title">Roman Numerals</h2>
                <p class="tool-description">Convert Roman numerals to numbers</p>
            </a>

            <a href="temperature-converter.html" class="tool-card" data-keywords="temperature celsius fahrenheit kelvin rankine delisle newton reaumur romer convert degrees" role="listitem">
                <h2 class="tool-title">Temperature Converter</h2>
                <p class="tool-description">Celsius, Fahrenheit, Kelvin, and more</p>
            </a>

            <a href="timestamp.html" class="tool-card" data-keywords="timestamp unix epoch date time timezone" role="listitem">
                <h2 class="tool-title">Timestamp</h2>
                <p class="tool-description">Unix timestamp with timezone support</p>
            </a>

            <a href="url-encoder.html" class="tool-card" data-keywords="url encode decode uri percent" role="listitem">
                <h2 class="tool-title">URL Encoder</h2>
                <p class="tool-description">Encode/decode URL components</p>
            </a>

            <a href="url-parser.html" class="tool-card" data-keywords="url parse query params anchor host path" role="listitem">
                <h2 class="tool-title">URL Parser</h2>
                <p class="tool-description">Decompose URL into components</p>
            </a>

            <a href="yaml-formatter.html" class="tool-card" data-keywords="yaml format pretty" role="listitem">
                <h2 class="tool-title">YAML Formatter</h2>
                <p class="tool-description">Pretty print and validate YAML</p>
            </a>

            <a href="xml-json.html" class="tool-card" data-keywords="xml json convert transform" role="listitem">
                <h2 class="tool-title">XML â†” JSON</h2>
                <p class="tool-description">Convert between XML and JSON</p>
            </a>
        </div>

        <p class="no-results" id="noResults" role="status">No tools match your filter.</p>
    </main>

    <script>
        const filterInput = document.getElementById('filterInput');
        const noResults = document.getElementById('noResults');
        const toolCards = document.querySelectorAll('.tool-card');
        let selectedIndex = -1;

        function getVisibleCards() {
            return Array.from(toolCards).filter(card => !card.classList.contains('hidden'));
        }

        function updateSelection(newIndex) {
            const visibleCards = getVisibleCards();

            // Clear previous selection
            toolCards.forEach(card => card.classList.remove('selected'));

            if (newIndex >= 0 && newIndex < visibleCards.length) {
                selectedIndex = newIndex;
                visibleCards[selectedIndex].classList.add('selected');
                visibleCards[selectedIndex].scrollIntoView({ block: 'nearest' });
            } else {
                selectedIndex = -1;
            }
        }

        function filterTools(query) {
            query = query.toLowerCase().trim();
            let visibleCount = 0;

            toolCards.forEach(card => {
                const title = card.querySelector('.tool-title').textContent.toLowerCase();
                const description = card.querySelector('.tool-description').textContent.toLowerCase();
                const keywords = (card.dataset.keywords || '').toLowerCase();
                const searchText = `${title} ${description} ${keywords}`;

                const isVisible = !query || searchText.includes(query);
                card.classList.toggle('hidden', !isVisible);
                if (isVisible) visibleCount++;
            });

            noResults.style.display = visibleCount === 0 ? 'block' : 'none';

            // Reset selection when filter changes
            updateSelection(-1);
        }

        filterInput.addEventListener('input', e => filterTools(e.target.value));

        function findCardInDirection(direction) {
            const visibleCards = getVisibleCards();
            if (selectedIndex < 0) return 0;

            const current = visibleCards[selectedIndex];
            const currentRect = current.getBoundingClientRect();
            const currentCenterX = currentRect.left + currentRect.width / 2;
            const currentCenterY = currentRect.top + currentRect.height / 2;

            let bestIndex = -1;
            let bestDistance = Infinity;

            visibleCards.forEach((card, index) => {
                if (index === selectedIndex) return;

                const rect = card.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;

                let isValid = false;
                if (direction === 'up') isValid = centerY < currentCenterY - 10;
                else if (direction === 'down') isValid = centerY > currentCenterY + 10;
                else if (direction === 'left') isValid = centerX < currentCenterX - 10 && Math.abs(centerY - currentCenterY) < 20;
                else if (direction === 'right') isValid = centerX > currentCenterX + 10 && Math.abs(centerY - currentCenterY) < 20;

                if (isValid) {
                    const dx = centerX - currentCenterX;
                    const dy = centerY - currentCenterY;
                    // Weight horizontal distance more for up/down, vertical for left/right
                    const distance = (direction === 'up' || direction === 'down')
                        ? Math.abs(dy) + Math.abs(dx) * 0.5
                        : Math.abs(dx) + Math.abs(dy) * 0.5;

                    if (distance < bestDistance) {
                        bestDistance = distance;
                        bestIndex = index;
                    }
                }
            });

            return bestIndex >= 0 ? bestIndex : selectedIndex;
        }

        filterInput.addEventListener('keydown', e => {
            const visibleCards = getVisibleCards();
            if (visibleCards.length === 0) return;

            const directions = { ArrowUp: 'up', ArrowDown: 'down', ArrowLeft: 'left', ArrowRight: 'right' };
            const direction = directions[e.key];

            if (direction) {
                e.preventDefault();
                if (selectedIndex < 0) {
                    updateSelection(0);
                } else {
                    updateSelection(findCardInDirection(direction));
                }
            } else if (e.key === 'Enter' && selectedIndex >= 0) {
                e.preventDefault();
                visibleCards[selectedIndex].click();
            }
        });

        const initialQuery = new URLSearchParams(window.location.search).get('q');
        if (initialQuery) {
            filterInput.value = initialQuery;
            filterTools(initialQuery);
        }
    </script>
</body>
</html>
